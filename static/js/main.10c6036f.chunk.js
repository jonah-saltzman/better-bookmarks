(this["webpackJsonpbetter-bookmarks-client"]=this["webpackJsonpbetter-bookmarks-client"]||[]).push([[0],{131:function(e,t,a){e.exports=a(235)},136:function(e,t,a){},139:function(e,t){},141:function(e,t){},175:function(e,t){},176:function(e,t){},220:function(e,t,a){},235:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(21),o=a.n(c),l=(a(136),a(5)),s=a(241),u=a(48),i=a(19),d=a(34),m=a(15),f=(a(218),a(219),a(220),a(9)),p=a.n(f),b=a(14),h=a(237),E=a(238),O=a(239),j=Object(r.createContext)(),w=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))?"http://127.0.0.1:4000":"https://betterbookmarks.herokuapp.com",v="https://twitter.com/i/oauth2/authorize?response_type=code&client_id=YnEzOGs2Y2pLMWRUTXM2X3dYU1g6MTpjaQ&redirect_uri="+w+"/twtauth?user=",g=new RegExp(/(?:\/)(\d+)(?:\/|\?|$)/),y=new RegExp(/^\d+$/),x=new RegExp(/(?<=a href=)[^ ]+(?=\?ref)/),k=function(){var e=Object(b.a)(p.a.mark((function e(t,a,r,n){var c,o,l,s,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=w+"/auth"+(n?"/signup":"/login"),console.log("authenticating with url: "),console.log(c),o={email:t,password:a,twtId:r||null},e.prev=4,e.next=7,fetch(c,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 7:return l=e.sent,s=l.status,e.next=11,l.json();case 11:if(u=e.sent,n){e.next=16;break}return e.abrupt("return",{error:200===s?null:u,success:200===s?u.message:null,token:u.token||null,userId:u.userId||null,twtChallenge:u.twtChallenge||null});case 16:if(200!==s){e.next=27;break}return e.next=19,k(t,a,null,!1);case 19:if(!(i=e.sent).success){e.next=24;break}return e.abrupt("return",{error:null,success:"Account created & logged in!",token:i.token,userId:i.userId,twtChallenge:i.twtChallenge});case 24:return e.abrupt("return",{error:"User ".concat(t," created but login failed.")});case 25:e.next=28;break;case 27:return e.abrupt("return",{error:u});case 28:e.next=34;break;case 30:return e.prev=30,e.t0=e.catch(4),console.error(e.t0),e.abrupt("return",{error:"Unknown error"});case 34:case"end":return e.stop()}}),e,null,[[4,30]])})));return function(t,a,r,n){return e.apply(this,arguments)}}(),S=function(){var e=Object(b.a)(p.a.mark((function e(t){var a,r,n,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w+"/user/signout",e.prev=1,e.next=4,fetch(a,{method:"Get",cache:"no-cache",headers:{Authorization:"JWT ".concat(t)}});case 4:return r=e.sent,n=r.status,e.next=8,r.json();case 8:if(c=e.sent,200!==n){e.next=13;break}return e.abrupt("return",{error:null,success:c.message});case 13:return e.abrupt("return",{error:c.message});case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(1),e.abrupt("return",{error:"Unknown error logging out."});case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(r.useContext)(j),t=e.state,a=e.dispatch,c=t.loggedIn,o=t.token,l=function(){var e=Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return Object(m.b)("No user to logout!",{type:"error"}),e.abrupt("return");case 3:return e.next=5,S(o);case 5:if(!(t=e.sent).error){e.next=9;break}return Object(m.b)(t.error,{type:"error"}),e.abrupt("return");case 9:Object(m.b)(t.success,{type:"success"}),["SET_USER","SET_LOGIN","SET_TOKEN","SET_FOLDERS","SET_USER_ID"].forEach((function(e){return a({type:e,payload:null})}));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(h.a,{sticky:"top",className:"nav"},n.a.createElement(E.a,{tag:i.b,to:"/",className:"text-white navbrand"},"Better Bookmarks"),n.a.createElement(i.c,{to:"/folders/view",className:"text-white"},"Folders"),n.a.createElement(i.c,{to:"/likes",className:"text-white"},"Likes"),n.a.createElement(i.c,{to:"/folders/import",className:"text-white"},"Import"),n.a.createElement(O.a,{className:"text-white float-right navtxt"},c?n.a.createElement("span",{onClick:l,className:"text-white text-large link"},"Logout"):n.a.createElement(i.c,{className:"text-white text-large",to:"/auth"},"Login")))},I=function(){return n.a.createElement(d.a,{to:"/"})},T=a(240),C=a(242),_=a(243),L=a(244),F=a(245),R=a(246),A=a(247),U=a(248),B=function(){var e=Object(r.useContext)(j),t=e.state,a=e.dispatch,c=t.loggedIn,o=Object(r.useState)(!1),u=Object(l.a)(o,2),i=u[0],f=u[1],h=Object(r.useState)(!1),E=Object(l.a)(h,2),O=E[0],w=E[1],v=Object(r.useState)(!0),g=Object(l.a)(v,2),y=g[0],x=g[1],S=Object(r.useState)(""),N=Object(l.a)(S,2),I=N[0],B=N[1],W=Object(r.useState)(""),z=Object(l.a)(W,2),D=z[0],J=z[1],G=Object(r.useState)(""),P=Object(l.a)(G,2),H=P[0],M=P[1],V=Object(r.useState)(""),$=Object(l.a)(V,2),K=$[0],Y=$[1],q=Object(r.useState)(!1),X=Object(l.a)(q,2),Q=X[0],Z=X[1],ee=function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==I&&""!==D&&(y||""!==H)){e.next=4;break}return Object(m.b)("Please complete all required fields.",{type:"error"}),e.abrupt("return");case 4:if(y||D===H){e.next=7;break}return Object(m.b)("Passwords do not match!",{type:"error"}),e.abrupt("return");case 7:w(!0),f(!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){i?Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(I,D,K,!y);case 2:(t=e.sent).error?Object(m.b)(t.error,{type:"error"}):(Object(m.b)(t.success,{type:"success"}),te(I,t)),w(!1),f(!1);case 6:case"end":return e.stop()}}),e)})))():w(!1)}),[i]);var te=function(e,t){a({type:"SET_USER",payload:e}),a({type:"SET_TOKEN",payload:t.token}),a({type:"SET_USER_ID",payload:t.userId}),a({type:"SET_TWT_CHALLENGE",payload:t.twtChallenge}),a({type:"SET_LOGIN",payload:!0})};return O?n.a.createElement("div",{className:"Center"},n.a.createElement(T.a,{color:"primary"}),n.a.createElement("div",{className:"text-primary"},"Loading...")):c?n.a.createElement(d.a,{to:"/folders/view"}):n.a.createElement(s.a,{fluid:!0,className:"mt-5 "},n.a.createElement(C.a,null,n.a.createElement(_.a,{md:"8",className:"offset-md-2 p-3 "},n.a.createElement(L.a,{className:"formcard auth-form",onSubmit:ee},n.a.createElement(F.a,{className:"mt-4"},n.a.createElement("input",{className:"input",type:"email",name:"email",id:"email",placeholder:"Email",value:I,onChange:function(e){return B(e.target.value)}})),n.a.createElement(F.a,null,n.a.createElement("input",{className:"input mt-2",type:"password",name:"password",id:"password",value:D,onChange:function(e){return J(e.target.value)},placeholder:"Password"})),y?n.a.createElement(F.a,{check:!0,className:"mt-2 ml-3"},n.a.createElement(R.a,{check:!0},n.a.createElement(A.a,{className:"checkmark",type:"checkbox",onChange:function(){Z(!Q)},checked:Q})," ",n.a.createElement("span",{className:"text-right",style:{color:"#f9f9f9",fontWeight:"400",letterSpacing:"1px"}},"Stay signed in"))):[n.a.createElement(F.a,{key:"password-confirm"},n.a.createElement("input",{className:"input mt-2",type:"password",name:"password-confirm",id:"password-confirm",value:H,onChange:function(e){return M(e.target.value)},placeholder:"Confirm password"})),n.a.createElement(F.a,{key:"twtId"},n.a.createElement("input",{className:"input mt-2",type:"text",name:"twtId",id:"twtId",value:K,onChange:function(e){return Y(e.target.value)},placeholder:"Twitter Username"}))],n.a.createElement(U.a,{color:"primary",type:"submit",block:!0,className:"text-uppercase "+(y?"mt-3":"mt-4"),style:{padding:"15px",fontSize:"18px"}},y?"Sign in":"Register")))),n.a.createElement(C.a,null,n.a.createElement(_.a,{md:"8",className:"offset-md-8"},n.a.createElement(U.a,{onClick:function(e){e.target.blur(),x(!y)},color:"secondary",className:"text-uppercase",style:{padding:"15px",fontSize:"18px"}},y?"Register":"Sign in"))))},W=a(249),z=a(250),D=a(251),J=function(e,t,a){return v+e+"&code_challenge="+t+"&scope=tweet.read%20like.read&state="+a+"&code_challenge_method=plain"},G=function(e){"?close"===e.location.search&&window.close();var t=Object(r.useContext)(j),a=t.state,c=(t.dispatch,a.loggedIn),o=a.userId,s=a.twtChallenge,u=a.twtState,i=Object(r.useState)(!1),d=Object(l.a)(i,2),m=d[0],f=d[1],p=Object(r.useState)(""),b=Object(l.a)(p,2),h=b[0],E=b[1];return Object(r.useEffect)((function(){c&&o?(E(J(o,s,u)),f(!0)):(E(""),f(!1))}),[c]),n.a.createElement("div",{className:"center-home"},n.a.createElement(W.a,{className:"homecard card-fab"},n.a.createElement(z.a,null,"Welcome to Better Bookmarks"),n.a.createElement(D.a,null,n.a.createElement("ul",null,n.a.createElement("li",null,"Organize your favorite Tweets into folders"),n.a.createElement("li",null,"Share folders with anyone"),n.a.createElement("li",null,'No more "This Tweet has been deleted"')),m?n.a.createElement("span",{className:"link",onClick:function(){window.open(h)}},"Login with Twitter"):null)))},P=function(){var e=Object(b.a)(p.a.mark((function e(t){var a,r,n,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w+"/user/folders",e.prev=1,e.next=4,fetch(a,{method:"GET",cache:"no-cache",headers:{Authorization:"JWT ".concat(t)}});case 4:return r=e.sent,n=r.status,e.next=8,r.json();case 8:if(c=e.sent,200!==n){e.next=13;break}return e.abrupt("return",{error:null,folders:c.folders});case 13:return e.abrupt("return",{error:c.message});case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(b.a)(p.a.mark((function e(t,a){var r,n,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w+"/user/folders/"+t,e.prev=1,e.next=4,fetch(r,{method:"GET",cache:"no-cache",headers:{Authorization:"JWT ".concat(a)}});case 4:return n=e.sent,c=n.status,e.next=8,n.json();case 8:if(o=e.sent,200!==c){e.next=13;break}return e.abrupt("return",{error:null,tweets:o.tweets});case 13:return e.abrupt("return",{error:o.message});case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",{error:e.t0});case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,a){return e.apply(this,arguments)}}(),M=function(){var e=Object(b.a)(p.a.mark((function e(t,a){var r,n,c,o,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w+"/user/folders",n=JSON.stringify({folderName:"".concat(t)}),e.prev=2,e.next=5,fetch(r,{method:"POST",cache:"no-cache",headers:{Authorization:"JWT ".concat(a),"Content-Type":"application/json"},body:n});case 5:return c=e.sent,o=c.status,e.next=9,c.json();case 9:if(l=e.sent,201!==o){e.next=14;break}return e.abrupt("return",{error:null,message:"Created folder ".concat(l.folder,"!")});case 14:return e.abrupt("return",{error:l.message});case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",{error:e.t0});case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,a){return e.apply(this,arguments)}}(),V=function(){var e=Object(b.a)(p.a.mark((function e(t,a){var r,n,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w+"/user/folders/"+t,e.prev=1,e.next=4,fetch(r,{method:"DELETE",cache:"no-cache",headers:{Authorization:"JWT ".concat(a)}});case 4:return n=e.sent,c=n.status,e.next=8,n.json();case 8:if(o=e.sent,200!==c){e.next=13;break}return e.abrupt("return",{error:null,message:"Deleted folder ".concat(o.folder.folderName,"!")});case 13:return e.abrupt("return",{error:o.message});case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",{error:e.t0});case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,a){return e.apply(this,arguments)}}(),$=function(){var e=Object(b.a)(p.a.mark((function e(t,a,r){var n,c,o,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("changing folder ".concat(t," to ").concat(a)),n=w+"/user/folders/"+t,c=JSON.stringify({newName:"".concat(a)}),e.prev=3,e.next=6,fetch(n,{method:"POST",cache:"no-cache",headers:{Authorization:"JWT ".concat(r),"Content-Type":"application/json"},body:c});case 6:return o=e.sent,l=o.status,e.next=10,o.json();case 10:if(s=e.sent,console.log(s.message),201!==l){e.next=16;break}return e.abrupt("return",{error:null,message:s.message});case 16:return e.abrupt("return",{error:s.message});case 17:e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(3),console.error(e.t0),e.abrupt("return",{error:e.t0});case 23:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(t,a,r){return e.apply(this,arguments)}}(),K=a(255),Y=a(254),q=a(128),X=a(125),Q=a(126),Z=a(256),ee=a(252),te=a(120),ae=a(39),re=a(40),ne=function(e){var t=e.folder,a=e.newFolder,c=e.refresh,o=e.selectFolder,s=e.selected,u=Object(r.useContext)(j),i=u.state,d=(u.dispatch,i.token),f=Object(r.useState)(!1),h=Object(l.a)(f,2),E=h[0],O=h[1],w=Object(r.useState)(a?"":t.folderName),v=Object(l.a)(w,2),g=v[0],y=v[1],x=Object(r.useState)(!1),k=Object(l.a)(x,2),S=k[0],N=k[1],I=Object(r.useState)(!1),T=Object(l.a)(I,2),C=T[0],_=T[1],L=Object(r.useState)(!1),F=Object(l.a)(L,2),R=F[0],A=F[1],U=Object(r.useState)(!1),B=Object(l.a)(U,2),W=B[0],z=B[1],D=Object(r.useState)(!1),J=Object(l.a)(D,2),G=J[0],P=J[1],H=function(){E||O(!0)},ne=function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),O(!1),a?_(!0):A(!0),N(!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){S&&Object(b.a)(p.a.mark((function e(){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=!0,e.next=e.t0===C?3:e.t0===G?11:e.t0===R?17:23;break;case 3:return console.log("attempting to create folder: ".concat(g)),_(!1),N(!1),y(""),e.next=9,M(g,d);case 9:return a=e.sent,e.abrupt("break",23);case 11:return P(!1),N(!1),e.next=15,V(t.folderId,d);case 15:return a=e.sent,e.abrupt("break",23);case 17:return A(!1),N(!1),e.next=21,$(t.folderId,g,d);case 21:return a=e.sent,e.abrupt("break",23);case 23:a.error?Object(m.b)(a.error,{type:"error"}):Object(m.b)(a.message,{type:"success"}),c();case 25:case"end":return e.stop()}}),e)})))()}),[S]);var ce=n.a.createElement(K.a,{onSubmit:ne},n.a.createElement("input",{className:"folder-input",type:"text",name:"folderName",id:"folderName",placeholder:"".concat(t.folderName),value:g,onChange:function(e){return y(e.target.value)},onBlur:function(){E&&(O(!1),y(a?"":t.folderName))},autoFocus:!0})),oe=n.a.createElement(Y.a,{show:W,backdrop:"static",keyboard:!1},n.a.createElement(re.a,null,n.a.createElement(q.a,null,"Are you sure you want to delete ",t.folderName,"?")),n.a.createElement(X.a,null,"This action cannot be undone."),n.a.createElement(Q.a,null,n.a.createElement(Z.a,{className:"btn-secondary",onClick:function(){W&&z(!1)}},"Cancel"),n.a.createElement(Z.a,{className:"btn-warning",onClick:function(){P(!0),z(!1),N(!0)}},"Delete")));return n.a.createElement(n.a.Fragment,null,n.a.createElement(ee.a,{style:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},n.a.createElement(te.a,{onClick:a?function(){return H()}:function(){return e=t.folderId,void o(e);var e},xs:"8",className:"text-large cardtxt",style:{fontWeight:"300",fontSize:"16px",letterSpacing:"1px"}},n.a.createElement("span",{className:"link "+(s?"selected-text":"")},E?ce:t.folderName.length<=(s?15:17)?t.folderName:t.folderName.substring(0,s?13:15)+"...")),n.a.createElement(te.a,{xs:"4",hidden:a,className:"float-end"},n.a.createElement(ae.a,{onClick:function(){W||z(!0)},color:"#FF6370",className:" icon",style:{zIndex:"1"}}),n.a.createElement(ae.b,{className:"icon ",color:"#54eafe",onClick:function(){return H()}}))),oe)},ce=a(2),oe=a(33),le=a(253),se=function(){var e=Object(b.a)(p.a.mark((function e(t,a,r){var n,c,o,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w+"/user/folders/"+t,c=JSON.stringify({tweets:a}),e.prev=2,e.next=5,fetch(n,{method:"PUT",cache:"no-cache",headers:{Authorization:"JWT ".concat(r),"Content-Type":"application/json"},body:c});case 5:return o=e.sent,l=o.status,e.next=9,o.json();case 9:if(s=e.sent,console.log(s),201!==l){e.next=15;break}return e.abrupt("return",{error:null,message:s});case 15:return e.abrupt("return",{error:s});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",{error:e.t0});case 22:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t,a,r){return e.apply(this,arguments)}}(),ue=function(){var e=Object(b.a)(p.a.mark((function e(t,a,r){var n,c,o,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w+"/user/folders/"+t,c=JSON.stringify({tweets:[a]}),e.prev=2,e.next=5,fetch(n,{method:"PATCH",cache:"no-cache",headers:{Authorization:"JWT ".concat(r),"Content-Type":"application/json"},body:c});case 5:return o=e.sent,l=o.status,e.next=9,o.json();case 9:if(s=e.sent,console.log(s),200!==l){e.next=15;break}return e.abrupt("return",{error:null,message:"Deleted tweet from "});case 15:return e.abrupt("return",{error:s});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",{error:e.t0});case 22:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t,a,r){return e.apply(this,arguments)}}(),ie=a(127),de=function(e){var t=e.tweet,a=e.load,c=e.embed,o=e.remove,s=e.display,i=Object(r.useState)(!1),d=Object(l.a)(i,2),m=d[0],f=d[1],p=Object(r.useState)(t.twtHtml.match(x)[0]),b=Object(l.a)(p,2),h=b[0],E=(b[1],Object(r.createRef)()),O=Object(r.createRef)(),j=Object(ie.useInViewport)(O,{disconnectOnLeave:!1},e),w=j.inViewport,v=j.enterCount,g="twt-".concat(t.twtId)+Object(u.randomBytes)(8).toString("hex"),y="div-".concat(t.twtId)+Object(u.randomBytes)(8).toString("hex");return Object(r.useEffect)((function(){m||v>1||!w||w&&f(!0)}),[w]),Object(r.useEffect)((function(){m&&m&&a(g)}),[m]),Object(r.useEffect)((function(){m&&s&&a(g)}),[s]),s?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{ref:O,className:"center",hidden:c},n.a.createElement(T.a,{color:"primary"})),n.a.createElement(ae.a,{onClick:function(){o(t.twtId)},className:"delete-tweet "+(c?"":"hidden")}),n.a.createElement("div",{id:y,ref:E,className:"tweet-div"},n.a.createElement("blockquote",{id:g,className:"twitter-tweet","data-conversation":"none","data-dnt":"true","data-theme":"dark"},n.a.createElement("a",{href:h})))):null},me=function(e){var t=e.folder,a=Object(r.useContext)(j),c=a.state,o=(a.dispatch,c.loggedIn),u=c.token,i=Object(r.useState)(!0),f=Object(l.a)(i,2),h=f[0],E=f[1],O=Object(r.useState)([]),w=Object(l.a)(O,2),v=w[0],g=w[1],y=Object(r.useState)([]),x=Object(l.a)(y,2),k=x[0],S=x[1],N=Object(r.useState)(!1),I=Object(l.a)(N,2),L=I[0],F=I[1],R=Object(r.useState)([]),A=Object(l.a)(R,2),U=A[0],B=A[1],W=Object(r.useState)(""),z=Object(l.a)(W,2),D=z[0],J=z[1],G=Object(r.useState)(null),P=Object(l.a)(G,2),M=P[0],V=P[1],$=Object(r.useState)(!1),K=Object(l.a)($,2),Y=K[0],q=K[1],X=Object(r.useState)(!0),Q=Object(l.a)(X,2),Z=(Q[0],Q[1],Object(r.useState)({colA:[],colB:[]})),ee=Object(l.a)(Z,2),te=ee[0],ae=ee[1];window.twttr.events.bind("rendered",(function(e){J(e.target.children[0].dataset.tweetId)}));var re=function(e){window.twttr.widgets.load(document.getElementById("".concat(e)))},ne=function(e){M||V(e)};Object(r.useEffect)((function(){M&&(Object(b.a)(p.a.mark((function e(){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue(t.folderId,M,u);case 2:(a=e.sent).error?Object(m.b)("Failed to delete Tweet",{type:"error"}):Object(m.b)(a.message+t.folderName,{type:"success"});case 4:case"end":return e.stop()}}),e)})))(),q(!0))}),[M]),Object(r.useEffect)((function(){if(Y){var e=Object(oe.a)(k).map((function(e){return e.twtId===M?Object(ce.a)({},e,{display:!1}):e}));S(e),V(null),q(!1),window.twttr.widgets.load()}}),[Y]),Object(r.useEffect)((function(){if(!U.includes(D)&&""!==D){var e=Object(oe.a)(U);e.push(D),B(e)}}),[D]),Object(r.useEffect)((function(){var e=Object(oe.a)(k).map((function(e){return U.some((function(t){return e.twtId===t}))?Object(ce.a)({},e,{loaded:!0}):e}));S(e)}),[U]),Object(r.useEffect)((function(){if(!t||null===t.folderId)return E(!1),void F(!0);S(k.map((function(e){return Object(ce.a)({},e,{display:!1})}))),B([]),o&&Object(b.a)(p.a.mark((function e(){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t.folderId,u);case 2:if(!(a=e.sent).error){e.next=7;break}return Object(m.b)("Error: ".concat(a.error)),E(!1),e.abrupt("return");case 7:a.tweets&&(F(!1),g(a.tweets),E(!1));case 8:case"end":return e.stop()}}),e)})))()}),[t]),Object(r.useEffect)((function(){0!==v.length?S(v.map((function(e){return{twtId:e.twtId,loaded:!1,tweet:e,display:!0}}))):ae({colA:[],colB:[]})}),[v]),Object(r.useEffect)((function(){if(0!==k.length){var e=[],t=[];k.filter((function(e){return!0===e.display})).forEach((function(a,r){r%2===0?e.push(n.a.createElement(le.a,{key:a.twtId,className:"tweetcard mb-4"},n.a.createElement(de,{load:re,tweet:a.tweet,embed:a.loaded,key:a.twtId,remove:ne,display:a.display}))):t.push(n.a.createElement(le.a,{key:a.twtId,className:"tweetcard mb-4"},n.a.createElement(de,{load:re,tweet:a.tweet,embed:a.loaded,key:a.twtId,remove:ne,display:a.display})))})),ae({colA:e,colB:t})}}),[k]);return o?h?n.a.createElement("div",{className:"Center"},n.a.createElement(T.a,{color:"primary"}),n.a.createElement("div",{className:"text-primary"},"Loading...")):n.a.createElement(n.a.Fragment,null," ",L?null:n.a.createElement(s.a,{className:"folder-title"},n.a.createElement(C.a,{className:"justify-content-md-center"},n.a.createElement(_.a,{md:"auto"},n.a.createElement("div",{className:"folderName"},t.folderName)))),n.a.createElement(s.a,{scrollable:"true",className:"mt-4 mb-5 tweet-list"},0!==v.length||h?n.a.createElement(C.a,null,n.a.createElement(_.a,null,te.colA),n.a.createElement(_.a,null,te.colB)):n.a.createElement("div",{className:"Center text-large cardtxt",style:{fontWeight:"700",fontSize:"32px",letterSpacing:"2px"}},"No Tweets (yet)!"))):n.a.createElement(d.a,{to:"/auth"})},fe=function(e,t){var a={};return e.error?(a.header="Failed to add Tweets",a.body="Logging in with Twitter may help. If you are already logged in with Twitter, ensure that your account has access to the Tweets you have selected.",a.link=!0,a.showBody=!0,a.error=!0,a):(a.remaining=[].concat(e.message.apiErrIds).concat(e.message.badIds),a.header="Added ".concat(e.message.bookmarkedCount," Tweets to ").concat(t),a.body=""+(e.message.duplicateCount>0?"".concat(e.message.duplicateCount," were already in folder.\n"):"")+(e.message.apiErrCount>0?"".concat(e.message.apiErrCount," could not be bookmarked. Logging in with Twitter may help.\n"):""),a.link=e.message.apiErrCount>0,a.showBody=a.body.length>=1,a.error=!1,console.log("returning resultObj: "),console.log(a),a)},pe=function(e){var t=e.fieldNumber,a=e.setValue,c=e.valid,o=e.validate,s=e.value,u=Object(r.useState)(""),i=Object(l.a)(u,2),d=i[0],m=i[1],f=Object(r.useState)(null),p=Object(l.a)(f,2),b=p[0],h=p[1];Object(r.useEffect)((function(){console.log("field #".concat(t,".valid=").concat(c)),h(c)}),[c]);return Object(r.useEffect)((function(){a(t,d)}),[d]),Object(r.useEffect)((function(){s!==d&&m(s)}),[s]),n.a.createElement("input",{className:"mb-4 "+(b?"valid"===b?"valid-input":"invalid-input":"folder-input"),type:"text",name:"tweetinput-".concat(t),id:"tweetinput-".concat(t),placeholder:"Tweet ID or URL",value:d,onChange:function(e){return m(e.target.value)},onFocus:function(){"valid"!==b&&h(null)},onBlur:function(){o(),h(c)}})},be=function(e){var t=e.folder,a=function(){return[0,1,2,3,4].map((function(e){return{number:e,value:"",valid:null}}))},c=Object(r.useContext)(j),o=c.state,u=(c.dispatch,o.token),d=Object(r.useState)(!1),f=Object(l.a)(d,2),h=f[0],E=f[1],O=Object(r.useState)([]),w=Object(l.a)(O,2),v=w[0],x=w[1],k=Object(r.useState)(!1),S=Object(l.a)(k,2),N=S[0],I=S[1],C=Object(r.useState)({}),_=Object(l.a)(C,2),R=_[0],A=_[1],B=Object(r.useState)(!1),W=Object(l.a)(B,2),z=W[0],D=W[1],J=function(){x(v.map((function(e){return 0===e.value.length?Object(ce.a)({},e,{valid:null}):g.test(e.value)||y.test(e.value)?Object(ce.a)({},e,{valid:"valid"}):Object(ce.a)({},e,{valid:"invalid"})})))};Object(r.useEffect)((function(){if(h){D(!0),E(!1);var e=v.reduce((function(e,t,a){return t.value.length>0&&"valid"===t.valid&&e.push(t.value),e}),[]);Object(b.a)(p.a.mark((function a(){var r;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,se(t.folderId,e,u);case 2:r=a.sent,A(fe(r,t.folderName)),D(!1),I(!0);case 6:case"end":return a.stop()}}),a)})))()}}),[h]),Object(r.useEffect)((function(){var e,t;0!==Object.keys(R).length&&(console.log("useEffect resultInfo"),console.log(R),console.log("remaining length: ".concat(null===(e=R.remaining)||void 0===e?void 0:e.length)),(null===(t=R.remaining)||void 0===t?void 0:t.length)>0?x(R.remaining.map((function(e,t){return{number:t,value:e,valid:"valid"}}))):x(a()))}),[R]),Object(r.useEffect)((function(){if(0!==v.length){var e=v[v.length-1];if(e.value.length>0){var t={number:e.number+1,value:"",valid:null};x([].concat(Object(oe.a)(v),[t]))}}else x(a())}),[v]);var G=function(e,t){x(v.map((function(a){return a.number===e?Object(ce.a)({},a,{value:t}):a})))},P=n.a.createElement(i.c,{to:"/twitter",className:"text-white"},"Login with Twitter"),H=n.a.createElement(Y.a,{show:N,backdrop:"static",keyboard:!1},n.a.createElement(re.a,null,n.a.createElement(q.a,null,R.header)),R.showBody?n.a.createElement(X.a,null,R.body,R.link?P:null):null,n.a.createElement(Q.a,null,n.a.createElement(U.a,{color:"primary",onClick:function(){A({}),N&&I(!1)}},"Done")));return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{hidden:!z,className:"Center"},n.a.createElement(T.a,{color:"primary"}),n.a.createElement("div",{className:"text-primary"},"Loading...")),n.a.createElement("div",{hidden:z},n.a.createElement(s.a,{className:"input-list"},n.a.createElement(L.a,{onSubmit:function(e){e.preventDefault(),J(),v.some((function(e){return"invalid"===e.valid}))?Object(m.b)("Some inputs are invalid!",{type:"error"}):E(!0)},className:"mt-4 text-center"},n.a.createElement(F.a,null,v.map((function(e){return n.a.createElement(pe,{key:e.number,setValue:G,fieldNumber:e.number,valid:e.valid,validate:J,value:e.value})}))),n.a.createElement(U.a,{color:"primary",type:"submit"},"Import Tweets")))),H)},he=function(){var e=Object(r.useContext)(j),t=e.state,a=(e.dispatch,t.loggedIn),c=t.token,o=Object(r.useState)(!0),u=Object(l.a)(o,2),i=u[0],f=u[1],h=Object(r.useState)(!1),E=Object(l.a)(h,2),O=E[0],w=E[1],v=Object(r.useState)([]),g=Object(l.a)(v,2),y=g[0],x=g[1],k=Object(r.useState)(null),S=Object(l.a)(k,2),N=S[0],I=S[1],L=Object(r.useState)(null),F=Object(l.a)(L,2),R=F[0],A=F[1],U=Object(r.useState)({folderId:null}),B=Object(l.a)(U,2),W=B[0],z=B[1],D=function(){w(!1),f(!0)},J=function(e){R.folderId!==e&&I(y.find((function(t){return t.folderId===e})))};return Object(r.useEffect)((function(){if(N)if(R){if(N.folderId===R.folderId&&N.tweets.length===R.tweets.length)return;z(N),A(N)}else z(N),A(N)}),[N]),Object(r.useEffect)((function(){O||a&&Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(c);case 2:if(!(t=e.sent).error){e.next=8;break}return Object(m.b)("Error: ".concat(t.error)),w(!0),f(!1),e.abrupt("return");case 8:t.folders&&(x(t.folders),w(!0),f(!1));case 9:case"end":return e.stop()}}),e)})))()}),[O]),Object(r.useEffect)((function(){0!==y.length&&I(R?y.find((function(e){return e.folderId===R.folderId})):y[0])}),[y]),a?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{hidden:!i,className:"Center"},n.a.createElement(T.a,{color:"primary"}),n.a.createElement("div",{className:"text-primary"},"Loading...")),n.a.createElement("div",{hidden:i},n.a.createElement(C.a,null,n.a.createElement(_.a,{md:3},n.a.createElement(s.a,{scrollable:"true",className:"folder-list pt-4 container-fluid no-padding"},n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"folder-listcard mb-4"},n.a.createElement(ne,{folder:{folderName:"New Folder"},key:"newFolder",newFolder:!0,refresh:D})),y.map((function(e){return n.a.createElement("div",{className:"mb-4 "+(e.folderId===W.folderId?"selected-folder":"folder-listcard")},n.a.createElement(ne,{folder:e,key:e.folderId,newFolder:!1,refresh:D,selectFolder:J,selected:e.folderId===W.folderId}))}))))),n.a.createElement(_.a,{md:9},n.a.createElement(d.d,null,n.a.createElement(d.b,{exact:!0,path:"/folders/view"},n.a.createElement(me,{folder:W})),n.a.createElement(d.b,{exact:!0,path:"/folders/import"},n.a.createElement(be,{folder:W}))))))):n.a.createElement(d.a,{to:"/auth"})},Ee=function(e,t){switch(t.type){case"SET_TWT_CHALLENGE":return null===t.payload?Object(ce.a)({},e,{twtChallenge:null}):Object(ce.a)({},e,{twtChallenge:t.payload});case"SET_USER_ID":return null===t.payload?Object(ce.a)({},e,{userId:null}):Object(ce.a)({},e,{userId:t.payload});case"SET_SINGLE_FOLDER_NAME":return Object(ce.a)({},e,{folderName:t.payload});case"SET_SINGLE_FOLDER":return Object(ce.a)({},e,{folder:t.payload});case"SET_PREV_USER":return null===t.payload?Object(ce.a)({},e,{prevUser:null}):Object(ce.a)({},e,{prevUser:t.payload});case"SET_SHOW_LOGOUT":return Object(ce.a)({},e,{showLogout:t.payload});case"RESET_SIGNIN":return Object(ce.a)({},e,{signIn:!0});case"SET_FOLDERS":return null===t.payload?Object(ce.a)({},e,{folders:[]}):Object(ce.a)({},e,{folders:t.payload});case"SET_LOGIN":return null===t.payload?Object(ce.a)({},e,{loggedIn:!1}):Object(ce.a)({},e,{loggedIn:t.payload});case"SET_USER":return null===t.payload?Object(ce.a)({},e,{user:null}):Object(ce.a)({},e,{user:t.payload});case"SET_TOKEN":return null===t.payload||!1===t.payload?Object(ce.a)({},e,{token:null}):Object(ce.a)({},e,{token:t.payload});default:return e}},Oe={showLogout:!1,inAuth:!1,loggedIn:!1,twtAuth:{authed:!1,twtId:null,twtToken:null,twtSecret:null},user:null,userId:null,twtChallenge:null,twtState:Object(u.randomBytes)(48).toString("hex"),prevUser:null,token:null,folders:[],folder:{},folerName:null,folderToUpdate:null,folderIdToUpdate:null},je=function(){var e=Object(r.useReducer)(Ee,Oe),t=Object(l.a)(e,2),a=t[0],c=t[1];a.loggedIn;return n.a.createElement(i.a,{basename:"better-bookmarks"},n.a.createElement(j.Provider,{value:{state:a,dispatch:c}},n.a.createElement(m.a,{theme:"dark"}),n.a.createElement(N,null),n.a.createElement(s.a,{fluid:!0,className:"h-75"},n.a.createElement(d.d,null,n.a.createElement(d.b,{exact:!0,path:"/auth",component:B}),n.a.createElement(d.b,{path:"/folders",component:he}),n.a.createElement(d.b,{exact:!0,path:"/",component:G}),n.a.createElement(d.b,{exact:!0,path:"*",component:I})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(je,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[131,1,2]]]);
//# sourceMappingURL=main.10c6036f.chunk.js.map